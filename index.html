<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Gestor de Comedor Escolar</title>
<script src="https://cdn.tailwindcss.com"></script>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
<!-- PWA Meta Tags -->
<meta name="theme-color" content="#ffffff">
<meta name="mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="Comedor">
<link rel="apple-touch-icon" href="https://placehold.co/192x192/8b0630/FFFFFF?text=CEVP">
<link rel="manifest" href="/manifest.json">

<!-- ===== Dise√±o claro con colores corporativos ===== -->
<style>
:root{
  --bg: #f6f7f9;
  --paper: #ffffff;
  --surface: #f8fafc;     /* liger√≠simo gris para listados */
  --text: #0f172a;
  --muted: #6b7280;
  --brand: #8b0630;       /* burdeos */
  --brand-dark: #700424;
  --accent: #19b4d6;
  --success: #067a46;
  --danger: #c92a2a;
  --card-border: rgba(15,23,42,0.06);
}

/* Base */
body {
  font-family: 'Inter', sans-serif;
  background-color: var(--bg);
  color: var(--text);
  margin: 0;
  -webkit-font-smoothing:antialiased;
}

/* Header */
header { padding: 1.25rem 0; }
header .logo { width:56px; height:56px; border-radius:10px; background:white; display:flex; align-items:center; justify-content:center; box-shadow:0 6px 20px rgba(15,23,42,0.04); border:1px solid var(--card-border); }

/* Headings */
h1,h2,h3,h4 { color: var(--brand); font-weight:700; margin-bottom:.35rem; }

/* Global buttons */
button {
  transition: transform .12s ease, box-shadow .12s ease;
  border-radius: 10px;
  font-weight: 600;
  padding: .6rem .9rem;
  box-shadow: 0 6px 18px rgba(15,23,42,0.04);
  border: 1px solid transparent;
  background: linear-gradient(180deg,#fff,#fbfbfb);
  color: var(--text);
  cursor: pointer;
}
button:hover { transform: translateY(-2px); }
button.primary {
  background: linear-gradient(180deg,var(--brand),var(--brand-dark));
  color: #fff;
  border-color: rgba(0,0,0,0.06);
}
button.ghost {
  background: transparent;
  border: 1px solid var(--card-border);
  color:var(--text);
}

/* Make primary larger pill-buttons (use class 'large') */
button.large {
  padding: .9rem 1.4rem;
  font-size: 1.05rem;
  border-radius: 999px;
  box-shadow: 0 12px 30px rgba(139,6,48,0.12);
}

/* Inputs */
input, select {
  background: #fff;
  color: var(--text);
  border: 1px solid var(--card-border);
  padding: .6rem .85rem;
  border-radius: 10px;
}
input:focus, select:focus { outline:none; box-shadow: 0 8px 24px rgba(25,180,214,0.10); border-color:var(--accent); }
/* ---------- Admin panel: dise√±o mejorado ---------- */
.admin-panel {
  background: linear-gradient(180deg,#ffffff,#fbfcfd);
  border-radius: 16px;
  padding: 1.4rem;
  border: 1px solid rgba(15,23,42,0.04);
  box-shadow: 0 18px 40px rgba(15,23,42,0.04);
}

/* Controles: dos columnas en desktop, 1 en m√≥vil */
.admin-panel .controls {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 1rem;
  align-items: center;
  justify-items: center;
  margin-top: 0.75rem;
}
@media (max-width:900px){
  .admin-panel .controls { grid-template-columns: 1fr; }
}

/* Grupo de botones (zona superior) */
.admin-panel .btn-row {
  display:flex;
  gap:1rem;
  align-items:center;
  justify-content:center;
  flex-wrap:wrap;
}

/* Destacar boton principal (import) */
button.primary {
  padding: .75rem 1.2rem;
  border-radius: 999px;
  font-size: 1.02rem;
  letter-spacing: .2px;
}

/* Aclarar apariencia del segundo boton */
button.ghost {
  padding: .6rem .95rem;
  background: #ffffff;
  border: 1px solid rgba(15,23,42,0.04);
  box-shadow: 0 6px 18px rgba(15,23,42,0.03);
}

/* Secci√≥n de exportaci√≥n ‚Äî centrada y espaciada */
.admin-panel .export-row {
  display:flex;
  gap:1rem;
  align-items:center;
  justify-content:center;
  flex-wrap:wrap;
  margin-top: .75rem;
}

/* Fecha + boton export: apariencia consistente */
#export-date-input {
  padding: .6rem .8rem;
  border-radius: 10px;
  border: 1px solid rgba(15,23,42,0.06);
  background: #fff;
}

/* Mensajes */
#import-status-initial, #import-status-dashboard {
  margin-top:.6rem;
  color: #059669;
  min-height:1rem;
  text-align:center;
}

/* Admin panel card (wrap) */
.admin-panel {
  background: white;
  border-radius: 14px;
  padding: 1.25rem;
  border: 1px solid var(--card-border);
  box-shadow: 0 18px 40px rgba(15,23,42,0.04);
}

/* Courses container & course card */
#courses-container { margin-top: 0.5rem; }
.course-card {
  background: white;
  border-radius: 12px;
  padding: 1rem;
  border: 1px solid var(--card-border);
  box-shadow: 0 10px 30px rgba(15,23,42,0.03);
  display:flex;
  flex-direction:column;
  gap: .75rem;
}
.course-card h3 { color:var(--brand); margin:0 0 .5rem 0; }

/* Student items: much clearer contrast */
.student-item {
  background: var(--surface);
  border-radius: 10px;
  padding: .7rem .9rem;
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:.6rem;
  border-left: 6px solid transparent;
  border: 1px solid rgba(15,23,42,0.04);
}
.student-item .name { font-weight:600; color:var(--text); font-size: 0.98rem; }
.student-item.pending { border-left-color: #cbd5e1; background: #ffffff; }
.student-item.present { 
  border-left-color: var(--success); 
  background-color: #dcfce7; /* Verde m√°s visible */
  box-shadow: 0 8px 20px rgba(6,122,70,0.04); 
}
.student-item.absent { border-left-color: var(--danger); background: linear-gradient(90deg, rgba(201,42,42,0.04), #fff); opacity: .95; text-decoration: line-through; }

/* mark-absent control */
.mark-absent-btn {
  width:42px; height:42px; border-radius:8px; display:inline-flex; align-items:center; justify-content:center; font-weight:700;
  border: 1px solid rgba(0,0,0,0.04);
}

/* Summary cards */
.summary-card { background: white; padding: .9rem; border-radius:12px; border:1px solid var(--card-border); box-shadow:0 10px 30px rgba(15,23,42,0.03); }

/* Report */
.report-wrapper { background: white; border-radius:12px; padding:1rem; border:1px solid var(--card-border); box-shadow:0 10px 30px rgba(15,23,42,0.04); }
.report-course .course-header { background: linear-gradient(90deg,var(--brand),var(--brand-dark)); color:#fff; padding:.6rem .9rem; font-weight:700; display:flex; justify-content:space-between; align-items:center; }
.report-scroll { overflow:auto; -webkit-overflow-scrolling:touch; }
.report-table { width:100%; border-collapse:collapse; font-size:13px; color:var(--text); }
.report-table thead th { position: sticky; top:0; background: #fff; z-index:2; border-bottom:2px solid rgba(15,23,42,0.06); padding:.45rem .5rem; text-align:center; font-weight:600; }
.report-table th:first-child, .report-table td:first-child { text-align:left; position: sticky; left:0; background:#fff; z-index:3; }
.report-table th, .report-table td { border:1px solid rgba(15,23,42,0.06); padding:.3rem .45rem; min-width:28px; text-align:center; }
.report-table tbody tr:nth-child(even) { background: rgba(15,23,42,0.02); }
.attendance-mark { width:22px; height:22px; display:inline-flex; align-items:center; justify-content:center; background:var(--success); color:#fff; border-radius:50%; font-weight:700; font-size:12px; }
.report-table td.total { font-weight:700; color:var(--brand); }

/* Small screens */
@media (max-width:900px){
  .report-table th, .report-table td { padding:.25rem .35rem; font-size:11px; min-width:22px; }
  .admin-panel .controls { flex-direction: column; gap: .75rem; }
}

/* print */
@media print {
  body > *:not(.printable-area) {
    display: none !important;
  }
  .printable-area {
    display: block !important;
    position: absolute;
    left: 0;
    top: 0;
    width: 100%;
    background: white;
    padding: 20px;
  }
  body { background:#fff !important; color:#000 !important; margin: 0; padding: 0; }
  .report-table thead th { background:#eee !important; -webkit-print-color-adjust:exact; }
  .report-table td, .report-table th { border:1px solid #ccc !important; }
  .attendance-mark { background:var(--success) !important; color:#fff !important; -webkit-print-color-adjust:exact; }
  
  /* Ajustes espec√≠ficos para la tabla del informe mensual */
  .report-table {
    width: 100% !important;
    font-size: 10px !important;
  }
  .report-table th, .report-table td {
    padding: 2px !important;
    min-width: 20px !important;
  }
  .report-course .course-header {
    background: #8b0630 !important;
    -webkit-print-color-adjust: exact;
  }
  
  /* Forzar dise√±o landscape para la impresi√≥n */
  @page {
    size: landscape;
    margin: 0.5cm;
  }
}

/* Modal para gesti√≥n de alumnos */
.fixed-modal {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background-color: rgba(0, 0, 0, 0.5);
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 1000;
}

.modal-content {
  background-color: white;
  border-radius: 12px;
  padding: 20px;
  width: 90%;
  max-width: 800px;
  max-height: 90vh;
  overflow-y: auto;
  box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
}

.student-list {
  max-height: 300px;
  overflow-y: auto;
  border: 1px solid #e5e7eb;
  border-radius: 8px;
  padding: 10px;
  margin-bottom: 15px;
}

.student-list-item {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 8px 12px;
  border-bottom: 1px solid #f3f4f6;
}

.student-list-item:last-child {
  border-bottom: none;
}

.checkbox-label {
  display: flex;
  align-items: center;
  gap: 8px;
  cursor: pointer;
}

.checkbox-label input[type="checkbox"] {
  width: 18px;
  height: 18px;
}

.tabs {
  display: flex;
  border-bottom: 1px solid #e5e7eb;
  margin-bottom: 15px;
}

.tab {
  padding: 10px 20px;
  cursor: pointer;
  border-bottom: 3px solid transparent;
}

.tab.active {
  border-bottom-color: #8b0630;
  color: #8b0630;
  font-weight: 600;
}

.tab-content {
  display: none;
}

.tab-content.active {
  display: block;
}

/* Nuevos estilos para la gesti√≥n de alumnos */
.student-management {
  margin-top: 20px;
}

.search-box {
  margin-bottom: 15px;
}

.search-box input {
  width: 100%;
  padding: 10px;
  border: 1px solid #d1d5db;
  border-radius: 8px;
}

.student-category {
  margin-bottom: 20px;
}

.category-title {
  font-weight: 600;
  color: #8b0630;
  margin-bottom: 10px;
  padding-bottom: 5px;
  border-bottom: 2px solid #f3f4f6;
}

.student-item-list {
  background-color: #f9fafb;
  border-radius: 8px;
  padding: 10px;
  margin-bottom: 10px;
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.student-actions {
  display: flex;
  gap: 8px;
}

.btn-sm {
  padding: 5px 10px;
  font-size: 0.875rem;
}

.btn-success {
  background-color: #067a46;
  color: white;
}

.btn-secondary {
  background-color: #6b7280;
  color: white;
}

/* Estilos para alumnos fijos y espor√°dicos */
.fixed-student {
  border-left: 4px solid #067a46;
}

.sporadic-student {
  border-left: 4px solid #19b4d6;
}
</style>
</head>
<body>

<!-- App principal -->
<div id="app" class="container mx-auto p-4 md:p-8 max-w-7xl">
  <header class="text-center mb-10">
    <div class="flex justify-between items-center">
        <div class="w-14"></div> <!-- Espaciador izquierdo -->
        <div class="flex flex-col items-center">
            <div class="logo"><img src="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='48' height='48'><rect fill='%23ffffff' width='48' height='48' rx='8'/><text x='50%' y='55%' font-size='18' text-anchor='middle' fill='%238b0630' font-family='Inter'>CEVP</text></svg>" alt="logo" style="width:44px;height:44px;border-radius:8px;"></div>
            <h1 class="text-4xl font-extrabold text-black mt-2">Gestor de Comedor</h1>
        </div>
        <div id="auth-controls" class="w-14">
            <button id="logout-btn" class="hidden ghost p-2" title="Cerrar Sesi√≥n">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"></path></svg>
            </button>
        </div>
    </div>
    <p id="role-display" class="text-muted text-slate-600 mt-2 font-semibold">Cargando...</p>
  </header>

  <!-- Login view / Main -->
  <div id="admin-login-view" class="hidden text-center bg-white p-8 rounded-2xl max-w-md mx-auto shadow-sm">
      <h2 class="text-2xl font-bold mb-6 text-black">Acceso de Administrador</h2>
      <button id="login-admin-btn" class="primary inline-flex items-center gap-3">
        <svg class="w-6 h-6" viewBox="0 0 24 24"><path fill="currentColor" d="M21.35,11.1H12.18V13.83H18.69C18.36,17.64 15.19,19.27 12.19,19.27C8.36,19.27 5,16.25 5,12C5,7.9 8.2,4.73 12.19,4.73C14.03,4.73 15.69,5.36 16.95,6.57L19.05,4.54C17.22,2.77 15,2 12.19,2C6.42,2 2.03,6.8 2.03,12C2.03,17.05 6.16,22 12.19,22C17.6,22 21.54,18.22 21.54,12.33C21.54,11.76 21.48,11.43 21.35,11.1V11.1Z"></path></svg>
        <span>Iniciar Sesi√≥n con Google</span>
      </button>
  </div>

  <div id="main-content" class="hidden">

      <!-- Selecci√≥n de turno -->
      <div id="shift-selection" class="text-center">
        <h2 class="text-2xl font-bold mb-6 text-black">Elige un turno de comedor</h2>
        <div id="shift-buttons" class="flex flex-wrap justify-center gap-6">
          <button class="primary large" data-shift="Primer Turno (Infantil)">Primer Turno (Infantil)</button>
          <button class="primary large" data-shift="Segundo Turno (Primaria)">Segundo Turno (Primaria)</button>
        </div>

        <div class="mt-12 pt-8 admin-panel admin-only">
          <h3 class="text-xl font-bold mb-2 text-center">Panel de Gesti√≥n</h3>
          <div class="mb-6">
            <h4 class="text-lg font-semibold mb-4 text-center" style="color:#475569;">Gesti√≥n de Datos</h4>
            <div class="btn-row" role="group" aria-label="gestion-datos">
              <button id="import-csv-btn-initial" class="primary" title="Importar CSV">üì§ Importar Alumnos (CSV)</button>
              <button id="manage-students-btn" class="primary" title="Gestionar alumnos">üë• Gestionar Alumnos</button>
              <button id="wipe-db" class="ghost" title="Borrar todos los alumnos">üóëÔ∏è Borrar todos los alumnos</button>
            </div>
            <p id="import-status-initial" class="text-center mt-3" style="min-height:18px"></p>
          </div>
          <hr style="border:none;border-top:1px solid rgba(15,23,42,0.04); margin: .8rem 0;">
          <div>
            <h4 class="text-lg font-semibold mb-4 text-center" style="color:#475569;">Consultas y Exportaci√≥n</h4>
            <div class="controls">
              <div class="btn-row">
                <button id="show-history-btn" class="bg-purple-600 text-white py-2 px-4 rounded-lg">üìú Historial por Alumno</button>
                <button id="show-monthly-report-btn" class="bg-sky-600 text-white py-2 px-4 rounded-lg">üìÖ Informe Mensual</button>
              </div>
              <div class="export-row">
                <input type="date" id="export-date-input" value="" aria-label="Fecha para exportar">
                <button id="export-csv-btn" class="primary">üíæ Exportar CSV del D√≠a</button>
              </div>
            </div>
          </div>
        </div>

      </div>

      <!-- Dashboard -->
      <main id="dashboard" class="hidden">
        <div class="flex flex-wrap justify-between items-center mb-6 gap-4">
          <button id="back-to-shifts" class="ghost">&larr; Volver a Turnos</button>
          <div class="flex flex-wrap gap-4">
            <button id="finalize-shift-btn" class="primary">üèÅ Finalizar Turno</button>
          </div>
        </div>

        <section id="summary" class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-8">
          <div class="summary-card text-center"><h3 class="text-lg font-semibold text-slate-600">Comensales</h3><p id="summary-diners" class="text-4xl font-bold">0</p></div>
          <div class="summary-card text-center"><h3 class="text-lg font-semibold text-rose-500">Ausentes</h3><p id="summary-absent" class="text-4xl font-bold">0</p></div>
          <div class="summary-card text-center"><h3 class="text-lg font-semibold text-amber-400">Pendientes</h3><p id="summary-pending" class="text-4xl font-bold">0</p></div>
          <div class="summary-card text-center"><h3 class="text-lg font-semibold text-emerald-400">Presentes</h3><p id="summary-present" class="text-4xl font-bold">0</p></div>
        </section>

        <section id="student-lists">
          <div id="courses-container" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"></div>
        </section>
      </main>
  </div>
</div>

<!-- Modal para gesti√≥n de alumnos -->
<div id="manage-students-modal" class="fixed-modal hidden">
  <div class="modal-content">
    <h2 class="text-2xl font-bold mb-4 text-center" style="color:var(--brand)">Gesti√≥n de Alumnos</h2>
    
    <div class="tabs">
      <div class="tab active" data-tab="fixed">Alumnos Fijos</div>
      <div class="tab" data-tab="sporadic">Alumnos Espor√°dicos</div>
      <div class="tab" data-tab="all">Todos los Alumnos</div>
    </div>
    
    <div class="tab-content active" id="fixed-tab">
      <div class="search-box">
        <input type="text" id="fixed-search" placeholder="Buscar alumnos fijos...">
      </div>
      <div class="student-list" id="fixed-students-list">
        <!-- Lista de alumnos fijos -->
      </div>
      <button id="add-fixed-btn" class="primary">A√±adir Alumnos Fijos</button>
    </div>
    
    <div class="tab-content" id="sporadic-tab">
      <div class="search-box">
        <input type="text" id="sporadic-search" placeholder="Buscar alumnos espor√°dicos...">
      </div>
      <div class="student-list" id="sporadic-students-list">
        <!-- Lista de alumnos espor√°dicos -->
      </div>
      <button id="add-sporadic-list-btn" class="primary">A√±adir Alumnos Espor√°dicos</button>
    </div>
    
    <div class="tab-content" id="all-tab">
      <div class="search-box">
        <input type="text" id="all-search" placeholder="Buscar todos los alumnos...">
      </div>
      <div class="student-list" id="all-students-list">
        <!-- Lista de todos los alumnos -->
      </div>
    </div>
    
    <div class="flex justify-end gap-4 mt-6">
      <button id="close-manage-modal" class="ghost">Cancelar</button>
      <button id="save-students-btn" class="primary">Guardar Cambios</button>
    </div>
  </div>
</div>

<!-- Resto del c√≥digo (modales existentes, scripts, etc.) -->
<!-- ... -->

<script>
// Aqu√≠ va todo el c√≥digo JavaScript existente, pero con las nuevas funciones a√±adidas

// Nueva funci√≥n para abrir el modal de gesti√≥n de alumnos
function openManageStudentsModal() {
  const modal = document.getElementById('manage-students-modal');
  modal.classList.remove('hidden');
  
  // Cargar la lista de alumnos
  loadAllStudentsForManagement();
}

// Funci√≥n para cargar todos los alumnos para su gesti√≥n
async function loadAllStudentsForManagement() {
  try {
    const allStudents = await fetchStudents(null);
    
    // Limpiar listas
    const fixedList = document.getElementById('fixed-students-list');
    const sporadicList = document.getElementById('sporadic-students-list');
    const allList = document.getElementById('all-students-list');
    
    fixedList.innerHTML = '';
    sporadicList.innerHTML = '';
    allList.innerHTML = '';
    
    // Separar alumnos fijos y espor√°dicos
    const fixedStudents = allStudents.filter(student => !student.id.startsWith('sporadic_'));
    const sporadicStudents = allStudents.filter(student => student.id.startsWith('sporadic_'));
    
    // Llenar lista de alumnos fijos
    fixedStudents.forEach(student => {
      const listItem = document.createElement('div');
      listItem.className = 'student-list-item fixed-student';
      listItem.innerHTML = `
        <label class="checkbox-label">
          <input type="checkbox" data-student-id="${student.id}" checked>
          <span>${student.name} - ${student.course}</span>
        </label>
        <div class="student-actions">
          <button class="btn-sm btn-secondary" onclick="moveToSporadic('${student.id}')">Mover a Espor√°dicos</button>
        </div>
      `;
      fixedList.appendChild(listItem);
    });
    
    // Llenar lista de alumnos espor√°dicos
    sporadicStudents.forEach(student => {
      const listItem = document.createElement('div');
      listItem.className = 'student-list-item sporadic-student';
      listItem.innerHTML = `
        <label class="checkbox-label">
          <input type="checkbox" data-student-id="${student.id}" checked>
          <span>${student.name.replace(' (Espor√°dico)', '')} - ${student.course}</span>
        </label>
        <div class="student-actions">
          <button class="btn-sm btn-success" onclick="moveToFixed('${student.id}')">Mover a Fijos</button>
        </div>
      `;
      sporadicList.appendChild(listItem);
    });
    
    // Llenar lista de todos los alumnos
    allStudents.forEach(student => {
      const isFixed = !student.id.startsWith('sporadic_');
      const listItem = document.createElement('div');
      listItem.className = `student-list-item ${isFixed ? 'fixed-student' : 'sporadic-student'}`;
      listItem.innerHTML = `
        <label class="checkbox-label">
          <input type="checkbox" data-student-id="${student.id}" ${isFixed ? 'checked' : ''}>
          <span>${isFixed ? student.name : student.name.replace(' (Espor√°dico)', '')} - ${student.course}</span>
        </label>
        <div class="student-actions">
          <button class="btn-sm ${isFixed ? 'btn-secondary' : 'btn-success'}" 
                  onclick="${isFixed ? `moveToSporadic('${student.id}')` : `moveToFixed('${student.id}')`}">
            ${isFixed ? 'Mover a Espor√°dicos' : 'Mover a Fijos'}
          </button>
        </div>
      `;
      allList.appendChild(listItem);
    });
    
  } catch (error) {
    console.error('Error loading students for management:', error);
  }
}

// Funciones para mover entre fijos y espor√°dicos
function moveToSporadic(studentId) {
  // L√≥gica para mover alumno a espor√°dicos
  console.log('Mover a espor√°dicos:', studentId);
  // Aqu√≠ implementar√≠as la l√≥gica para cambiar el estado del alumno
}

function moveToFixed(studentId) {
  // L√≥gica para mover alumno a fijos
  console.log('Mover a fijos:', studentId);
  // Aqu√≠ implementar√≠as la l√≥gica para cambiar el estado del alumno
}

// En el event listener principal, a√±adir:
document.getElementById('manage-students-btn').addEventListener('click', openManageStudentsModal);
document.getElementById('close-manage-modal').addEventListener('click', () => {
  document.getElementById('manage-students-modal').classList.add('hidden');
});

// Funcionalidad de pesta√±as
document.querySelectorAll('.tab').forEach(tab => {
  tab.addEventListener('click', () => {
    // Desactivar todas las pesta√±as
    document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
    document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
    
    // Activar la pesta√±a clickeada
    tab.classList.add('active');
    const tabId = tab.dataset.tab;
    document.getElementById(`${tabId}-tab`).classList.add('active');
  });
});

// Funcionalidad de b√∫squeda
document.getElementById('fixed-search').addEventListener('input', filterStudents);
document.getElementById('sporadic-search').addEventListener('input', filterStudents);
document.getElementById('all-search').addEventListener('input', filterStudents);

function filterStudents(e) {
  const searchTerm = e.target.value.toLowerCase();
  const tabId = e.target.id.replace('-search', '');
  const studentItems = document.querySelectorAll(`#${tabId}-students-list .student-list-item`);
  
  studentItems.forEach(item => {
    const studentName = item.querySelector('span').textContent.toLowerCase();
    item.style.display = studentName.includes(searchTerm) ? 'flex' : 'none';
  });
}
</script>
</body>
</html>
